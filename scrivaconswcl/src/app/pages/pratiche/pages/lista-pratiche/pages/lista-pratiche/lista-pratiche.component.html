<!--
* ========================LICENSE_START=================================
* 
* Copyright (C) 2025 Regione Piemonte
* 
* SPDX-FileCopyrightText: (C) Copyright 2025 Regione Piemonte
* SPDX-License-Identifier: EUPL-1.2
* =========================LICENSE_END==================================
-->
<div class="page">
  <app-breadcrumbs [overrideBreadcrumbs]="breadcrumbs"></app-breadcrumbs>

  <div class="practice-detail row">
    <div class="col-12">
      <h1>
        {{ 'PRACTICE.LIST.TITLE' | translate }}
      </h1>
    </div>
    <div class="col-12">
      <div class="separator">&nbsp;</div>
    </div>

    <!--        <div class="col-12">-->
    <!--            <h6 class="m-0 pt-2">{{ ambito?.des_ambito }}</h6>-->
    <!--            <h6 class="m-0">{{ tipoAdempimento?.des_tipo_adempimento }}</h6>-->
    <!--        </div>-->
  </div>
</div>
<div class="row button-row" style="padding-top: 30px; line-height: 40px">
  <div class="col-auto col-button-stato" *ngFor="let stato of praticheStati">
    <button
      [class.bg-yellow]="
        stato.label.toUpperCase() === 'IN CONSULTAZIONE' &&
        selectedStatus !== stato.label
      "
      [class.text-blue]="
        stato.label.toUpperCase() === 'IN CONSULTAZIONE' &&
        selectedStatus !== stato.label
      "
      type="button"
      class="btn btn-stato-pratica"
      [ngClass]="{
        'btn-primary': selectedStatus === stato.label,
        'btn-outline-primary': selectedStatus !== stato.label
      }"
      (click)="onChangeStatus(stato.label)"
    >
      {{ stato.label }} ({{ stato.value }})
    </button>
  </div>
</div>
<div class="row pl-0">
  <div class="col pl-0">
    <div class="total-elements pl-1">
      {{ getNumberOfElements() }}
      {{ 'UTILS.TABLE.NUMBER_OF_ELEMENTS' | translate }}
    </div>
  </div>
  <div class="col text-right pt-4" *ngIf="!!getNumberOfElements()">
    <button
      type="button"
      class="btn custom-button-outline"
      (click)="exportCSV()"
    >
      {{ 'UTILS.TABLE.DOWNLOAD_EXCEL' | translate }}
    </button>
  </div>
</div>
<app-card
  [containerStyle]="
    'box-shadow: 1px 2px 8px #c4c4c4 !important; border-radius: 0 !important;'
  "
>
  <app-card-body>
    <app-table
      [columns]="columns"
      [dataSource]="dataSource"
      [showPager]="true"
    ></app-table>
  </app-card-body>
</app-card>

<app-back></app-back>

<ng-template #settingsTemplate let-row="row">
  <a class="list-item px-0 pt-1 cursor-pointer" (click)="onDetail(row)">
    <app-icon
      *ngIf="detailIcon.icon"
      [name]="detailIcon.icon.name"
      [type]="detailIcon.icon.type"
      [cssClass]="detailIcon.icon.cssClass"
      [fill]="detailIcon.icon.fill"
      [size]="detailIcon.icon.size"
      [color]="detailIcon.icon.color"
      [padding]="detailIcon.icon.padding"
      [baseHref]="detailIcon.icon.baseHref"
      title="{{ 'PRACTICE.LIST.ICONS.PAPER' | translate }}"
    ></app-icon>
  </a>
  <!-- Oscuramento momentaneo per messa in produzione-->
  <!-- <ng-container *ngIf="row.flg_osservazione">
    <a
      class="list-item px-0 pt-1"
      *ngIf="checkDataFineOsservazione(row); else disabledIcon"
      (click)="onNewRemark(row)"
    >
      <app-icon
        name="eng-remark"
        type="eng"
        cssClass="cursor-pointer"
        size="small"
        fill="#005095"
        title="{{ 'PRACTICE.LIST.ICONS.NEW_REMARK' | translate }}"
      >
      </app-icon> </a
  ></ng-container> -->
</ng-template>

<ng-template #disabledIcon>
  <a class="list-item px-0 pt-1">
    <app-icon
      name="eng-disabled-remark"
      type="eng"
      size="small"
      fill="#005095"
      title="{{ 'PRACTICE.LIST.ICONS.NEW_REMARK' | translate }}"
    >
    </app-icon> </a
></ng-template>
